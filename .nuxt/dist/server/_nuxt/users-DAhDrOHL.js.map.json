{"file":"users-DAhDrOHL.js","mappings":"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","names":["route"],"sources":["../../../../client/components/Breadcrumbs.vue","../../../../client/components/ui/button/danger.vue","../../../../client/stores/admin/users.ts","../../../../client/stores/enums.ts","../../../../client/components/dialogs/admin/users.vue","../../../../client/pages/admin-panel/users.vue"],"sourcesContent":["<template>\n    <div class=\"mb-4\">\n        <nav class=\"flex mb-5\" aria-label=\"Breadcrumb\">\n            <ol class=\"inline-flex items-center space-x-1 text-sm font-medium md:space-x-2\">\n                <li class=\"inline-flex items-center\">\n                    <NuxtLink :to=\"{name: 'index'}\" class=\"inline-flex items-center text-gray-700 hover:text-primary-600 dark:text-gray-300 dark:hover:text-white\">\n                        <svg class=\"w-5 h-5 mr-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z\"></path></svg>\n                        Главная\n                    </NuxtLink>\n                </li>\n                <li\n                    v-for=\"(crumb, index) in crumbsRoute\"\n                    :key=\"crumb.name\"\n                >\n                    <div class=\"flex items-center\">\n                        <svg class=\"w-6 h-6 text-gray-400\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\" clip-rule=\"evenodd\"></path></svg>\n                        <NuxtLink v-if=\"index != Object.keys(crumbsRoute).length - 1\" :to=\"{ name: crumb.name }\" class=\"ml-1 text-gray-700 hover:text-primary-600 md:ml-2 dark:text-gray-300 dark:hover:text-white\">{{ crumb.meta.breadcrumbs }}</NuxtLink>\n                        <span v-else class=\"ml-1 text-gray-400 md:ml-2 dark:text-gray-500\">{{ crumb.meta.breadcrumbs }}</span>\n                    </div>\n                </li>\n            </ol>\n        </nav>\n    </div>\n</template>\n\n<script setup>\n    const route = useRoute();\n    const router = useRouter();\n\n    const crumbsRoute = computed(() => {\n    let fullPath = \"\";\n    const routes = route.fullPath.substring(1).split(\"/\");\n    return routes\n    .map((route) => {\n        if (route) {\n            fullPath = `${fullPath}/${route}`;\n            return router.resolve(fullPath);\n        }\n    })\n    .filter(Boolean);\n});\n</script>\n\n<style lang=\"scss\" scoped>\n</style>\n","<script setup lang=\"ts\">\nconst props = defineProps({\n    disabled: {\n        default: false\n    },\n    type: {\n        default: 'button'\n    }\n})\n</script>\n<template>\n    <button :disabled=\"props.disabled\" :type=\"props.type\" data-modal-toggle=\"delete-user-modal\" class=\"inline-flex items-center px-3 py-2 text-sm font-medium text-center text-white bg-red-600 rounded-lg hover:bg-red-800 focus:ring-4 focus:ring-red-300 dark:focus:ring-red-900\">\n        <slot/>\n    </button>\n</template>\n","import { acceptHMRUpdate, defineStore } from 'pinia'\nimport _ from 'lodash';\n\nexport const useAdminUsers = defineStore('adminUsers', {\n    state: () => ({\n        loading: false,\n        items: <models.User>[],\n        laravelData: <models.UsersResults>[],\n        meta: <api.MetApiPaginate | undefined>[],\n        current: null,\n        filter_params: [],\n    }),\n\n    getters: {\n\n    },\n\n    actions: {\n        async get(par?: object): Promise<models.UsersResults> {\n            this.loading = true\n\n            try {\n                const params = JSON.parse(JSON.stringify(par))\n\n                const {data, error} = await useApi('admin/users', {\n                    params\n                })\n\n                if (error.value) {\n                    // @ts-ignore\n                    throw new Error(error.value)\n                }\n\n                this.laravelData = data?.value?.data;\n                this.items = data?.value?.data?.data;\n                this.meta = data?.value?.data?.meta\n            } catch (e) {\n                console.log(e)\n            }\n\n            this.loading = false\n        },\n\n        async update(id: number, body: object|FormData) {\n            this.loading = true\n\n            try {\n                if (body instanceof FormData) {\n                    body.append('_method', 'put')\n                } else {\n                    // @ts-ignore\n                    body._method = 'put'\n                }\n\n                const {data, error} = await useApi(`admin/users/${id}`, {\n                    method: 'post',\n                    headers: {\n                        'Accept': 'application/json',\n                    },\n                    body\n                })\n\n                if (error.value) {\n                    // @ts-ignore\n                    throw new Error(error.value)\n                }\n\n                const { $toast } = useNuxtApp()\n                $toast.success('Данные о пользователе успешно обновлены')\n            } catch (e) {\n                console.log(e)\n            }\n\n            this.loading = false\n        },\n\n        async store(body: object): Promise<models.UserResults> {\n            this.loading = false\n\n            try {\n                const {data, error} = await useApi(`admin/users`, {\n                    method: 'post',\n                    headers: {\n                        'Accept': 'application/json',\n                    },\n                    body\n                })\n\n                if (error.value) {\n                    // @ts-ignore\n                    throw new Error(error.value)\n                }\n\n                const { $toast } = useNuxtApp()\n                $toast.success('Создан новый пользователь')\n            } catch (e) {\n                console.log(e)\n            }\n\n\n            this.loading = true\n        },\n\n        async destroy(id: number) {\n            this.loading = true\n\n            try  {\n                await useApi(`admin/users/${id}`, {\n                    method: 'delete',\n                })\n            } catch (e) {\n                console.log(e)\n            }\n\n            this.loading = false\n        },\n    }\n})\n\n// @ts-ignore\nif (import.meta.hot) {\n    import.meta.hot.accept(acceptHMRUpdate(useAdminUsers, import.meta.hot))\n}\n\n","import { acceptHMRUpdate, defineStore } from 'pinia'\n\ninterface State {\n}\n\nexport const useEnum = defineStore('enum', {\n    state: (): State => ({\n        loading: false,\n        userRoles: [],\n        userStatuses: [],\n    }),\n\n    getters: {\n\n    },\n\n    actions: {\n        async getUserRoles() {\n            this.loading = true\n\n            try {\n                const { data, error } = await useApi(`enums/user_roles`)\n\n                if (error.value) {\n                    // @ts-ignore\n                    throw new Error(error.value)\n                }\n\n                this.userRoles = data?.value?.data\n            } catch(e) {\n                console.log(e)\n            }\n\n            this.loading = false\n        },\n\n        async getUserStatuses() {\n            this.loading = true\n\n            try {\n                const { data, error } = await useApi(`enums/user_statuses`)\n\n                if (error.value) {\n                    // @ts-ignore\n                    throw new Error(error.value)\n                }\n\n                this.userStatuses = data?.value?.data\n            } catch(e) {\n                console.log(e)\n            }\n\n            this.loading = false\n        },\n    }\n})\n\n// @ts-ignore\nif (import.meta.hot) {\n    import.meta.hot?.accept(acceptHMRUpdate(useEnum, import.meta.hot))\n}\n\n","<script setup lang=\"ts\">\nimport { useDialog } from '~/stores/dialog'\nimport { useAdminUsers } from \"~/stores/admin/users\"\nimport { useEnum } from '~/stores/enums';\n\nconst props = defineProps({\n    modelValue: {\n        type: Object\n    }\n})\nconst emit = defineEmits(['update:modelValue', 'fetchPageData'])\n\nconst enumStore = useEnum()\nconst dialog = useDialog()\nconst adminUserStore = useAdminUsers()\nconst router = useRouter()\nconst editModal = ref(props.modelValue)\n\nasync function fetchParams() {\n    if (Object.keys(enumStore.userRoles).length === 0) {\n        await enumStore.getUserRoles()\n    }\n\n    if (Object.keys(enumStore.userStatuses).length === 0) {\n        await enumStore.getUserStatuses()\n    }\n}\nfetchParams()\nformClear()\n\nwatch(() => dialog.dialogs.adminUser.active, v => {\n    formClear()\n\n    if (v) {\n        bodyFixed()\n        showModal()\n    } else {\n        bodyNotFixed()\n        closeModal()\n    }\n})\n\nwatch(() => props.modelValue, v => {\n    editModal.value = v\n}, {\n    deep: true\n})\n\nfunction formClear() {\n    for (let name in editModal.value.form) {\n        editModal.value.form[name] = ''\n    }\n}\n\nconst fetchPageData = () => {\n    emit('fetchPageData');\n}\n\nasync function submit() {\n    const m = editModal.value\n    const data = JSON.parse(JSON.stringify(m.form))\n\n    if (m.item) {\n        await adminUserStore.update(m.item.id, data)\n    } else {\n        await adminUserStore.store(data)\n    }\n\n    formClear()\n    closeModal()\n\n    emit('update:modelValue', m)\n    await fetchPageData()\n}\n\nfunction closeModal() {\n    editModal.value.show = false;\n    emit('update:modelValue', editModal.value)\n    dialog.close('adminUser')\n}\n\nfunction showModal() {\n    editModal.value.show = true\n    if (! editModal.value.formDefault) {\n        editModal.value.formDefault = Object.assign({}, editModal.value.form)\n    } else {\n        editModal.value.form = Object.assign({}, editModal.value.formDefault)\n    }\n\n    const item = editModal.value.item\n    if (item) {\n        editModal.value.title = `Редактирование пользователя: ${item.name} (ID - ${item.id})`\n        for (let name in editModal.value.form) {\n            if (name === 'role') {\n                editModal.value.form[name] = enumStore.userRoles.find(role => role.display_name === item[name]).name;\n                continue;\n            }\n            if (item.hasOwnProperty(name)) {\n                editModal.value.form[name] = item[name]\n            }\n        }\n    } else {\n        editModal.value.title = 'Добавление пользователя'\n    }\n}\n</script>\n\n<template>\n    <!-- authorization Popup -->\n    <DialogModal :noFooter=\"false\" :show=\"dialog.dialogs.adminUser.active\" @close=\"closeModal()\">\n        <template #title>\n            <section class=\"bg-gray-50 dark:bg-gray-900\">\n                <div class=\"w-full space-y-4 py-4 bg-white rounded-lg dark:bg-gray-800\">\n                    <h2 class=\"text-2xl font-bold text-gray-900 dark:text-white\">\n                        {{ editModal.title }}\n                    </h2>\n                </div>\n            </section>\n        </template>\n        <template #content>\n            <div class=\"\">\n                <form>\n                    <div class=\"grid grid-cols-6 gap-6\">\n                        <div class=\"col-span-6 sm:col-span-3\">\n                            <label for=\"name\" class=\"block mb-2 text-sm font-medium text-gray-900 dark:text-white\">Имя</label>\n                            <input v-model=\"editModal.form.name\" type=\"text\" name=\"name\" id=\"name\" class=\"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500\" placeholder=\"ФИО\">\n                        </div>\n                        <div class=\"col-span-6 sm:col-span-3\">\n                            <label for=\"phone\" class=\"block mb-2 text-sm font-medium text-gray-900 dark:text-white\">Номер телефона</label>\n                            <input v-model=\"editModal.form.phone\" type=\"text\" name=\"phone\" id=\"phone\" class=\"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500\" placeholder=\"+79998887766\">\n                        </div>\n                        <div class=\"col-span-6 sm:col-span-3\">\n                            <label for=\"email\" class=\"block mb-2 text-sm font-medium text-gray-900 dark:text-white\">Email</label>\n                            <input v-model=\"editModal.form.email\" type=\"email\" name=\"email\" id=\"email\" class=\"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500\" placeholder=\"example@company.com\">\n                        </div>\n                        <div class=\"col-span-6 sm:col-span-3\">\n                            <label for=\"password\" class=\"block mb-2 text-sm font-medium text-gray-900 dark:text-white\">Пароль</label>\n                            <input v-model=\"editModal.form.password\" type=\"password\" name=\"password\" id=\"password\" class=\"shadow-sm bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500\" placeholder=\"********\">\n                        </div>\n                        <div class=\"col-span-6 sm:col-span-3\">\n                            <label for=\"status\" class=\"block mb-2 text-sm font-medium text-gray-900 dark:text-white\">Статус</label>\n                            <select v-model=\"editModal.form.status\" id=\"status\" name=\"status\" class=\"border bg-gray-50 border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500\">\n                                <option v-for=\"status in enumStore.userStatuses\" :value=\"status.value\" >{{ status.value }}</option>\n                            </select>\n                        </div>\n                        <div class=\"col-span-6 sm:col-span-3\">\n                            <label for=\"role\" class=\"block mb-2 text-sm font-medium text-gray-900 dark:text-white\">Роль</label>\n                            <select v-model=\"editModal.form.role\" id=\"role\" name=\"role\" class=\"border bg-gray-50 border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-primary-500 dark:focus:border-primary-500\">\n                                <option v-for=\"role in enumStore.userRoles\" :value=\"role.name\">{{ role.display_name }}</option>\n                            </select>\n                        </div>\n                    </div>\n                </form>\n            </div>\n        </template>\n        <template #footer>\n            <div class=\"items-center pt-8 pb-4 rounded-b dark:border-gray-700\">\n                <uiButtonPrimary @click=\"submit\" :disabled=\"adminUserStore.loading\" type=\"button\">\n                    {{ adminUserStore.loading ? 'Загрузка...' : editModal.item ? 'Обновить' : 'Добавить' }}\n                </uiButtonPrimary>\n            </div>\n        </template>\n    </DialogModal>\n</template>\n<style lang=\"scss\">\nselect {\n    -webkit-appearance: none;\n    -moz-appearance: none;\n    appearance: none;\n    -o-appearance: none;\n    print-color-adjust: exact;\n    background-image: url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3E%3Cpath stroke='%236B7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3E%3C/svg%3E\");\n    background-position: right .5rem center;\n    background-repeat: no-repeat;\n    background-size: 1.5em 1.5em;\n    padding-right: 2.5rem;\n}\n</style>\n","<script setup lang=\"ts\">\ndefinePageMeta({\n    name: \"admin-panel-users\",\n    breadcrumbs: \"Пользователи\",\n});\n\nimport { useEnum } from '~/stores/enums';\nimport { useAdminUsers } from \"~/stores/admin/users\";\nimport { useDialog } from \"~/stores/dialog\";\nimport _ from 'lodash';\nimport * as pkg from 'laravel-vue-pagination';\n\nconst { TailwindPagination } = pkg;\n\nconst sorting: any = ref([\n    {\n        name: 'ID по возрастанию',\n        value: 'id-asc',\n    },\n    {\n        name: 'ID по убыванию',\n        value: 'id-desc',\n    },\n    {\n        name: 'ФИО по возрастанию (А - Я)',\n        value: 'name-asc',\n    },\n    {\n        name: 'ФИО по убыванию (Я - А)',\n        value: 'name-desc',\n    },\n    {\n        name: 'Номер телефона (по возрастанию)',\n        value: 'phone-asc',\n    },\n    {\n        name: 'Номер телефона (по убыванию)',\n        value: 'phone-desc',\n    },\n]);\n\nconst adminUserStore = useAdminUsers();\nconst enumStore = useEnum();\nconst dialog = useDialog();\n\ntype i_FORM = Pick<models.User, 'name' | 'email' | 'phone' | 'avatar_url' | 'role' | 'status' | 'password'> & {\n    avatar: File | null\n}\n\nconst filter = reactive({\n    role: null,\n    status: '',\n    sort: '',\n    per_page: null,\n    page: 1\n})\n\nfunction changePage(page: int) {\n    filter.page = page;\n}\n\nwatch(filter, v => {\n    adminUserStore.get(filter);\n})\n\nconst editModal = reactive<{\n    show: boolean\n    title: string\n    formRef: HTMLFormElement | null\n    form: i_FORM\n    formDefault?: i_FORM\n    item: models.User | null\n}>({\n    show: false,\n    title: '',\n    formRef: null,\n    form: {\n        name: '',\n        email: '',\n        phone: '',\n        password: '',\n        role: '',\n        status: '',\n    },\n    item: null\n})\n\nasync function fetchParams() {\n    if (Object.keys(enumStore.userRoles).length === 0) {\n        await enumStore.getUserRoles()\n    }\n\n    if (Object.keys(enumStore.userStatuses).length === 0) {\n        await enumStore.getUserStatuses()\n    }\n}\nfetchParams();\nadminUserStore.get(filter);\n\nasync function destroy(item: models.User) {\n    if (! confirm('Действие необратимо!\\nВы уверены?')) {\n        return\n    }\n    await adminUserStore.destroy(item.id)\n    await adminUserStore.get(filter);\n}\n\nfunction showModal(item?: models.User) {\n    console.log('click')\n    dialog.open('adminUser')\n    console.log(dialog.dialogs.adminUser.active)\n    editModal.item = item || null\n}\n</script>\n<template>\n    <div class=\"p-4 bg-white block sm:flex items-center justify-between border-b border-gray-200 lg:mt-1.5 dark:bg-gray-800 dark:border-gray-700\">\n        <div class=\"w-full mb-1\">\n            <Breadcrumbs />\n            <div class=\"sm:flex\">\n                <h1 class=\"text-xl font-semibold text-gray-900 sm:text-2xl dark:text-white\">Все пользователи</h1>\n                <div class=\"flex items-center ml-auto space-x-2 sm:space-x-3\">\n                    <ui-button-primary\n                        :disabled=\"adminUserStore.loading && enumStore.loading\"\n                        @click=\"showModal()\"\n                    >\n                        <svg class=\"w-5 h-5 mr-2 -ml-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" d=\"M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z\" clip-rule=\"evenodd\"></path></svg>\n                        Добавить пользователя\n                    </ui-button-primary>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"flex flex-col\">\n        <div class=\"overflow-x-auto\">\n            <div class=\"inline-block min-w-full align-middle\">\n                <div class=\"overflow-hidden shadow\">\n                    <table class=\"min-w-full divide-y divide-gray-200 table-fixed dark:divide-gray-600\">\n                        <thead class=\"bg-gray-100 dark:bg-gray-700\">\n                        <tr>\n                            <th scope=\"col\" class=\"p-4\">\n                                ID\n                            </th>\n                            <th scope=\"col\" class=\"p-4 text-xs font-medium text-left text-gray-500 uppercase dark:text-gray-400\">\n                                ФИО\n                            </th>\n                            <th scope=\"col\" class=\"p-4 text-xs font-medium text-left text-gray-500 uppercase dark:text-gray-400\">\n                                Номер телефона\n                            </th>\n                            <th scope=\"col\" class=\"p-4 text-xs font-medium text-left text-gray-500 uppercase dark:text-gray-400\">\n                                Роль\n                            </th>\n                            <th scope=\"col\" class=\"p-4 text-xs font-medium text-left text-gray-500 uppercase dark:text-gray-400\">\n                                Статус\n                            </th>\n                            <th scope=\"col\" class=\"p-4 text-xs font-medium text-left text-gray-500 uppercase dark:text-gray-400\">\n\n                            </th>\n                        </tr>\n                        </thead>\n                        <tbody class=\"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700\">\n                            <tr v-for=\"user in adminUserStore.items\" class=\"hover:bg-gray-100 dark:hover:bg-gray-700\">\n                                <td class=\"p-4 text-base text-center font-medium text-gray-900 whitespace-nowrap dark:text-white\">{{ user.id }}</td>\n                                <td class=\"flex items-center p-4 mr-12 space-x-6 whitespace-nowrap\">\n<!--                                    <img class=\"w-10 h-10 rounded-full\" src=\"https://flowbite-admin-dashboard.vercel.app/images/users/neil-sims.png\" alt=\"Neil Sims avatar\">-->\n                                    <div class=\"text-sm font-normal text-gray-500 dark:text-gray-400\">\n                                        <div class=\"text-base font-semibold text-gray-900 dark:text-white\">{{ user.name }}</div>\n                                        <div class=\"text-sm font-normal text-gray-500 dark:text-gray-400\">{{ user.email }}</div>\n                                    </div>\n                                </td>\n                                <td class=\"max-w-sm p-4 overflow-hidden text-base font-normal text-gray-500 truncate xl:max-w-xs dark:text-gray-400\">{{ user.phone }}</td>\n                                <td class=\"p-4 text-base font-medium text-gray-900 whitespace-nowrap dark:text-white\">{{ user.role ?? '-' }}</td>\n                                <td class=\"p-4 text-base font-medium text-gray-900 whitespace-nowrap dark:text-white\">{{ user.status }}</td>\n                                <td class=\"p-4 space-x-2 whitespace-nowrap\">\n                                    <ui-button-primary\n                                        :disabled=\"adminUserStore.loading && enumStore.loading\"\n                                        @click=\"showModal(user)\"\n                                    >\n                                        <svg class=\"w-4 h-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z\"></path><path fill-rule=\"evenodd\" d=\"M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z\" clip-rule=\"evenodd\"></path></svg>\n                                        Редактировать\n                                    </ui-button-primary>\n                                    <ui-button-danger\n                                        :disabled=\"adminUserStore.loading && enumStore.loading\"\n                                        @click=\"destroy(user)\"\n                                    >\n                                        <svg class=\"w-4 h-4 mr-2\" fill=\"currentColor\" viewBox=\"0 0 20 20\" xmlns=\"http://www.w3.org/2000/svg\"><path fill-rule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clip-rule=\"evenodd\"></path></svg>\n                                        Удалить\n                                    </ui-button-danger>\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n                    <span v-if=\"adminUserStore.items.length == 0 && (adminUserStore.loading || enumStore.loading)\">Загрузка...</span>\n                    <span v-if=\"adminUserStore.items.length == 0 && (!adminUserStore.loading && !enumStore.loading)\">Нет пользователей</span>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class=\"sticky bottom-0 right-0 items-center w-full p-4 bg-white border-t border-gray-200 sm:flex sm:justify-between dark:bg-gray-800 dark:border-gray-700\">\n        <TailwindPagination\n            class=\"mt-4\"\n            :data=\"adminUserStore.laravelData\"\n            @pagination-change-page=\"changePage\"\n        />\n    </div>\n\n   <dialogsAdminUsers v-model=\"editModal\" @fetchPageData=\"adminUserStore.get(filter)\"/>\n</template>\n"],"version":3}